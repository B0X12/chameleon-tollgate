package com.chameleon.tollgate.otp.Activity.RestServer;import android.content.Context;import android.os.AsyncTask;import android.os.Handler;import android.os.Message;import android.util.Log;import androidx.annotation.NonNull;import com.chameleon.tollgate.Util;import com.chameleon.tollgate.define.LogTag;import com.chameleon.tollgate.faceauth.FaceMsg;import com.chameleon.tollgate.faceauth.FacePack;import com.chameleon.tollgate.faceauth.FaceVar;import com.chameleon.tollgate.rest.ErrorResponse;import com.chameleon.tollgate.rest.HttpStatus;import com.chameleon.tollgate.rest.Response;import com.chameleon.tollgate.rest.RestConnection;import com.chameleon.tollgate.rest.RestResult;import com.chameleon.tollgate.rest.define.Method;import com.chameleon.tollgate.rest.define.Path;import com.google.gson.Gson;public class RestOtpTask extends AsyncTask<Void, Void, String> {    private Context context;    private Handler handler;    private RestOtpPack ROP;    public RestOtpTask(@NonNull RestOtpPack ROP, @NonNull Context context, @NonNull Handler handler) {        this.ROP = ROP;        this.context = context;        this.handler = handler;    }    @Override    protected String doInBackground(Void... voids) {        RestConnection rest = new RestConnection(this.context, Path.DATA_OTP, Method.POST, true);        rest.setBody(ROP);        if (rest == null)            return ReturnMessage.FAIL;        try {            RestResult result = rest.request();            Log.d(LogTag.REST_OTP, "Result : " + result);            if (result.responseCode != HttpStatus.OK.value) { //http 200 check                ErrorResponse err = new Gson().fromJson(result.result, ErrorResponse.class);                Message msg = this.handler.obtainMessage(FaceMsg.TOAST_ERROR, err.getMessage());                this.handler.sendMessage(msg);                return ReturnMessage.FAIL;            }            Response<String> respon = new Gson().fromJson(result.result, Response.class);            if (this.ROP.getTimestamp() != respon.getTimestamp())            {                Message msg = this.handler.obtainMessage(FaceMsg.TOAST_ERROR, "Invalid response.");                this.handler.sendMessage(msg);                return ReturnMessage.FAIL;            }            return respon.getResult();        } catch (Exception e) {};        return ReturnMessage.FAIL;    }    @Override    protected void onPostExecute(String result)    {        super.onPostExecute(result);        // doInBackground()로 부터 반환된 값이 매개변수로 넘어온다.        Log.d(FaceVar.TAG, "replied result : "+result);    }}